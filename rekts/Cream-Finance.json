{
    "id": 2596,
    "project_name": "Cream Finance",
    "title": "Cream Finance",
    "description": "<p><strong>Quick Summary</strong></p><p>Cream Finance got exploited through a vulnerability hidden in the borrow() function, which was repeatedly utilized for reentrancy attacks. The attacker made away with approx. $36 million.</p><p><br></p><p><strong>Details of the Exploit</strong></p><p>Cream (Crypto Rules Everything Around Me) Finance is a decentralized lending protocol designed for institutions, protocols and people in order to access financial services.</p><p>The risk for reentrancy arose because of the way $AMP was integrated into the protocol. The $AMP token contract is based on the ERC777 standard, which utilizes the _callPostTransferHooks hook. The attack transactions started with supplying $ETH as a collateral for borrowing $AMP from the crAMP market. When transferring AMP to the attacking contract, the _callPostTransferHooks was called, which in turn triggered the execution of a fallback function in the attack contract allowing the latter to re-enter the crETH market to borrow $ETH against the very same collateral initially supposed to be used for borrowing $AMP.</p><p>The flow of an example exploit transaction: https://etherscan.io/tx/0xa9a1b8ea288eb9ad315088f17f7c7386b9989c95b4d13c81b69d5ddad7ffe61e</p><p>- The hacker creates contract A to flash loan 500 $WETH and use the funds as collateral on cream, minting 24.17k crETH;</p><p>- borrows 19.48M $AMP for the received crETH;</p><p>- exploits the reentrancy possibility by repeatedly calling borrow() during the token transfer, taking a further 355 $ETH before the state of the initial borrow() has been updated;</p><p>- uses contract B, which receives a half (9.74M) of A's borrowed $AMP;</p><p>- contract B liquidates part of A's loan, redeeming 187 $WETH and transferring it back to contract A;</p><p>- contract A uses $ETH borrowed via reentrancy to repay the remainder of the flash loan.</p><p><br></p><p>The profits of the above explained transaction amounted to 41 $ETH and 9.74M $AMP.</p><p>In total, 17 attack transactions were conducted netting the attackers a total of $AMP 462,079,976 and $ETH 2,804.96.</p><p><br></p><p><strong>Block Data Reference</strong></p><p>Attack contract A:</p><p>https://etherscan.io/address/0x38c40427efbaae566407e4cde2a91947df0bd22b</p><p>Attack contract B:</p><p>https://etherscan.io/address/0x0ec306D7634314D35139d1dF4A630d829475A125</p><p>Exploiter address 1:</p><p>https://etherscan.io/address/0xce1f4b4f17224ec6df16eeb1e3e5321c54ff6ede</p><p>Exploiter address 2:</p><p>https://etherscan.io/address/0x8036EbD0Fc9C120BA0469ffCB27b204AA06aaF1F</p><p><br></p>",
    "name_categories": "Borrowing and Lending",
    "token_name": "CREAM",
    "proof_archive_link": null,
    "technical_issue": null,
    "token_address": "https://etherscan.io/token/0x2ba592F78dB6436527729929AAf6c908497cB200",
    "token_addresses": [],
    "logo_link": "safe/files/scamDatabase/logo/612f92d19c475.jpeg",
    "date": "2021-8-31",
    "scam_updates": [],
    "proof_link": "https://medium.com/cream-finance/c-r-e-a-m-finance-post-mortem-amp-exploit-6ceb20a630c5, https://rekt.news/cream-rekt/",
    "website_link": "https://cream.finance/",
    "webarchive_link": null,
    "twitter_link": "https://twitter.com/CreamdotFinance",
    "telegram_link": "https://t.me/CreamdotFinance",
    "our_post_link": null,
    "funds_lost": 36154954,
    "funds_returned": 0,
    "funds_by_chains": [],
    "funds_recovered": null,
    "active": 1,
    "git_hub": null,
    "git_hub_contract_link": null,
    "discord": null,
    "bug_bounty_program_link": null,
    "bug_bounty_program_company": null,
    "audit_code_conf": null,
    "is_verified_source_code": 0,
    "is_public_team": 0,
    "scam_type": {
        "id": 19,
        "type": "Other"
    },
    "network": {},
    "scamNetworks": [
        {
            "networks_id": 1,
            "scam_database_id": 2596,
            "networks": {
                "id": 1,
                "name": "Ethereum",
                "icon_link": "safe/files/network/ethereum.png"
            }
        }
    ],
    "auditedBy": []
}