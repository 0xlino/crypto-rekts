{
    "id": 2825,
    "project_name": "Superfluid",
    "title": "Superfluid",
    "description": "<p><strong>Quick Summary</strong></p><p>Superfluid protocol was exploited which lead to a loss of project funds for roughly 20,000,000 $USD.</p><p><br><strong>Details of the Exploit</strong><br>Superfluid is a streaming protocol for real-time crypto transfers. On February 8, 2022, an attacker exploited Superfluid\u2019s host contract by passing in faulty calldata, which allowed them to create distribution indexes spoofing several different accounts that held Super-tokens. This vulnerability enabled the attacker to move funds from Superfluid user wallets to exchanges on Polygon and swap them to ETH. The funds currently sit in the attacker\u2019s wallet.</p><p>In total, 11,008 MATIC, 1,507,931 MOCA, 28 ETH, 39,357 sdam3CRV, 19,387,874 QI, 44,581 SDT, 23,653 STACK, and 562,834 USDC were stolen by the attacker. At the time of writing, over 2,700 ETH is sitting in the attacker\u2019s wallet, as well as 500,000 MOCA.<br><br><u>callAgreement</u>() function was exploited by replacing the bytes memory callData parameter. This parameter contains ctx value which can be decoded to get such properties: timestamp, msgSender, agreementSelector, userData, appAllowanceGranted, appAllowanceWanted, appAllowanceUsed, appAddress, appAllowanceToken. Ctx was replaced with the fake one, so the attacker was able to drain all SuperToken contract funds.</p><p><br></p><p><strong>Block Data Reference</strong><br>Attacker address:<br>https://polygonscan.com/address/0x1574f7f4c9d3aca2ebce918e5d19d18ae853c090</p><p><br></p><p>Malicious transaction:<br>https://polygonscan.com/tx/0x396b6ee91216cf6e7c89f0c6044dfc97e84647f5007a658ca899040471ab4d67</p><p><br></p><p>Malicious contract:</p><p>https://polygonscan.com/address/0x32d47ba0affc9569298d4598f7bf8348ce8da6d4<br><br>Claim transaction:<br>https://polygonscan.com/tx/0xdee86cae2e1bab16496a49b2ec61aae0472a7ccf06f79744d42473e96edd6af6</p>",
    "name_categories": "Other",
    "token_name": "SuperQI",
    "proof_archive_link": "https://archive.ph/ApG1H, https://archive.ph/mfDJY, https://archive.ph/e5usK",
    "technical_issue": null,
    "token_address": "https://polygonscan.com/token/0xe1ca10e6a10c0f72b74df6b7339912babfb1f8b5",
    "token_addresses": [
        {
            "address": "0xe1ca10e6a10c0f72b74df6b7339912babfb1f8b5",
            "url": "https://polygonscan.com/address/0xe1ca10e6a10c0f72b74df6b7339912babfb1f8b5",
            "network": {
                "id": 137,
                "icon_link": "safe/files/network/involved/polygon.svg"
            }
        }
    ],
    "logo_link": "safe/files/scamDatabase/logo/62053904ab461.png",
    "date": "2022-2-8",
    "scam_updates": [],
    "proof_link": "https://twitter.com/QiDaoProtocol/status/1490944375165128706, https://beincrypto.com/qidao-experiences-exploit-of-superfluid-smart-contract-code-20m-estimated-to-be-lost/, https://twitter.com/Superfluid_HQ/status/1491045880107048962",
    "website_link": "https://www.superfluid.finance/",
    "webarchive_link": null,
    "twitter_link": "https://twitter.com/Superfluid_HQ",
    "telegram_link": null,
    "our_post_link": null,
    "funds_lost": 20000000,
    "funds_returned": 0,
    "funds_by_chains": [],
    "funds_recovered": null,
    "active": 1,
    "git_hub": "https://github.com/superfluid-finance",
    "git_hub_contract_link": null,
    "discord": "https://discord.com/invite/JrnpZWymeU",
    "bug_bounty_program_link": null,
    "bug_bounty_program_company": null,
    "audit_code_conf": 0,
    "is_verified_source_code": 1,
    "is_public_team": 0,
    "scam_type": {
        "id": 19,
        "type": "Other"
    },
    "network": {},
    "scamNetworks": [
        {
            "networks_id": 137,
            "scam_database_id": 2825,
            "networks": {
                "id": 137,
                "name": "Polygon",
                "icon_link": "safe/files/network/polygon.png"
            }
        }
    ],
    "auditedBy": []
}