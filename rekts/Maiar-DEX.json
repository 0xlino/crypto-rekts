{
    "id": 3040,
    "project_name": "Maiar DEX",
    "title": "Maiar DEX",
    "description": "<p><strong>Quick Summary</strong></p><p>Maiar DEX was the victim of an attack by hackers who found and exploited a vulnerability in order to empty the reserves of the protocol. Due to this vulnerability, when a $WEGLD contract called a Maiar contract, it allowed Maiar to perform a token transfer in the context of the $WEGLD contract, the calling party. Maiar DEX was successfully recovered by the Elrond team, and user funds were not affected</p><p><br></p><p><strong>Details of the Exploit</strong></p><p>The Maiar DEX protocol was attacked by hackers who took advantage of a vulnerability in the WEGLD contract to steal funds from the protocol on the Elrond network. The attacker's accounts were created almost simultaneously and tokens in the amount of 1.959 $EGLD were sent to each of them from Binance Hot Wallet:</p><p><br></p><p>Block Data Reference</p><p>1) https://explorer.elrond.com/transactions/ba7bcea55911973556c0c855a912c868e76a658792b62a6688c16a14c98a0102</p><p>2) https://explorer.elrond.com/transactions/27935d8bceaee5b179bddb1dcd9683a3c227055c8ac70b4bd5f3a40a2b5f6dd1</p><p>3) https://explorer.elrond.com/transactions/73f39d3edf0cf5f0893fa3a8175f614329960572e2843f6a21f60b5e1bf778f5</p><p><br></p><p>After the accounts were created and smart contracts as well, they called the withdraw() function and received a total of 1,650,000 $EGLD. The most important here is the wrat_egls_callback() function. This function enables the wrapping and unwrapping of the $EGLD token.</p><p><br></p><p>In the transaction below, it can be noticed that as the new smart contract sends a small amount of $EGLD to the wrapEgId() method and this method sends $WEDLD to the wrap_edId_callback() method of the new contract:</p><p style=\"margin:0cm;background:white;\">https://explorer.elrond.com/transactions/848b5a96bd95d3537f2bb8cfc5c1ebc5ec580e72214dd75c85be718ae0bbf3fb#4159433916247dbdbfbbf31d8a4cc8ce14a3a86e5a5f7beb1cddcf5abc59b83e</p><p><br></p><p>Deploying the wrap_egId_callback() method, was found a call of the managedExecuteOnDestContextByCaller() method, which allows attacker to \"ask\" the victim's contract to send funds to any other address that the attacker indicates, which happened during the attack on Maiar DEX. The Elrond team paused the work of Maiar DEX, they also froze stablecoins so that the hacker would not be able to withdraw funds through the bridge to another network. Having connections with other major exchanges, they handed over a blacklist with addresses so that the fraudster would not be able to withdraw funds. The executeOnDestContextByCaller() function was removed to avoid a repeat attack. Then the team began to restore the liquidity pool by returning all funds and restoring the price of the token, based on the price indicated by Binance.</p><p><br></p><p>Block Data Reference</p><p>Attacker addresses:</p><p>1) https://explorer.elrond.com/accounts/erd1cura2qq8skel5fsxrpxyysjkaw6durengtkencrezkw78y6y2zhscf854j</p><p>2) https://explorer.elrond.com/accounts/erd1yrf9qeuqkcjeh5c4xn628mags7cse4r9ra2p2ggmlgfqq3l3v6pqxfu950</p><p>3) https://explorer.elrond.com/accounts/erd16syfkds2faezhqa7pn5n8fyjkst70l5qefpmc0r960467snlgycq4ww0rt</p><p><br></p><p>Contract addresses:</p><p>1) https://explorer.elrond.com/accounts/erd1qqqqqqqqqqqqqpgq85hhnppjcdamledp3usgkm3lm832jekw2zhsajjztn</p><p>2) https://explorer.elrond.com/accounts/erd1qqqqqqqqqqqqqpgqqucnpav4dguh4zf6nvd48l68k2nxhyu0v6pqqntgfs</p><p>3) https://explorer.elrond.com/accounts/erd1qqqqqqqqqqqqqpgqll7yerx6v67p0s8va0h09dgv7x30nlergycqt2qzmp</p><p><br></p><p>Contract deployment transaction by the attacker address (erd1...854j): https://explorer.elrond.com/transactions/9404479926078441d8fd8844ec4787c4c35c554628abdc7605c8084f49299352&nbsp;</p><p>Contract deployment transaction by the attacker address (erd1...u950): https://explorer.elrond.com/transactions/39c7aebfe5ebbe4bcc285ef5cc99869486705afa4ce94071c5aafc6124864fb7</p><p>Contract deployment transaction by the attacker address (erd1...ww0rt): https://explorer.elrond.com/accounts/erd1qqqqqqqqqqqqqpgqll7yerx6v67p0s8va0h09dgv7x30nlergycqt2qzmp</p><p><br></p><p>Transactions of theft of funds from the Maiar DEX:</p><p>400k EGLD: https://explorer.elrond.com/transactions/8b8c332577e5b8bdd4e13450ea92b7c6b0ca15399f1f0bb38fc215cfc3ddb490</p><p>450k EGLD: https://explorer.elrond.com/transactions/39998ab5c929fa67e95d0c64081697fc4207235dbfeaaff10fb2704a6c7716b6</p><p>800k EGLD: https://explorer.elrond.com/transactions/41effd8536376f3a2edba7074c02776edae94bb5b464485ac414847202eebbe2</p><p><br></p><p style=\"margin:0cm;background:white;\">Recovered funds were send to one of Elrond addresses: https://explorer.elrond.com/accounts/erd1pml9k2tsqsnvtmmalglt2su0sn3cguvr8e8jq0gy69zw2ldcej2qapml9a</p>",
    "name_categories": "Exchange (DEX)",
    "token_name": "MEX",
    "proof_archive_link": "https://web.archive.org/web/20220607130601/https://twitter.com/beniaminmincu/status/1534159591180750850, https://twitter.com/foudres_/status/1533702059001790465?s=21&t=-gQgPNE3ieeQOsLWxnar1A, https://web.archive.org/web/20220607170701/https://twitter.com/CertiKAlert/status/1534220168792092674, https://web.archive.org/web/20220606064816/https://twitter.com/foudres_/status/1533702059001790465, https://web.archive.org/web/20220608184501/https://twitter.com/arda_project/status/1534607414170984448",
    "technical_issue": null,
    "token_address": "https://elrondscan.com/token/MEX-455c57",
    "token_addresses": [],
    "logo_link": "safe/files/scamDatabase/logo/62a07c73b4e09.png",
    "date": "2022-6-5",
    "scam_updates": [],
    "proof_link": "https://www.bitdegree.org/crypto/news/maiar-dex-loses-113-million-worth-of-egld-after-going-offline, https://elrond.com/blog/incident-and-recovery-report/, https://cryptotodayinfo.com/%F0%9F%9A%ABelrond-hacked-%E2%A4%B5%EF%B8%8Fegld-to-5-in-seconds-%E2%8F%AF%EF%B8%8Fexchange-paused-%F0%9F%94%9Cwhere-will-it-all-end/",
    "website_link": "https://maiar.exchange/",
    "webarchive_link": null,
    "twitter_link": "https://twitter.com/getMaiar",
    "telegram_link": null,
    "our_post_link": null,
    "funds_lost": 113000000,
    "funds_returned": 113000000,
    "funds_by_chains": [],
    "funds_recovered": null,
    "active": 1,
    "git_hub": null,
    "git_hub_contract_link": null,
    "discord": null,
    "bug_bounty_program_link": null,
    "bug_bounty_program_company": null,
    "audit_code_conf": null,
    "is_verified_source_code": 1,
    "is_public_team": 1,
    "scam_type": {
        "id": 19,
        "type": "Other"
    },
    "network": {},
    "scamNetworks": [
        {
            "networks_id": 1005,
            "scam_database_id": 3040,
            "networks": {
                "id": 1005,
                "name": "Elrond",
                "icon_link": "safe/files/network/elrond.png"
            }
        }
    ],
    "auditedBy": []
}