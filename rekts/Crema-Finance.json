{
    "id": 3071,
    "project_name": "Crema Finance",
    "title": "Crema Finance",
    "description": "<p><strong>Quick Summary</strong></p><p>Crema Finance was attacked by a white hat hacker for ~$8.8M who then returned the majority of stolen funds, leaving the attacker with 45455 $SOL as a reward for finding the exploit. The Solana network became the place of the exploit, and all funds were transferred by the attacker through the Wormhole Bridge to the ETH network and swapped to 6K $ETH.</p><p><br></p><p><strong>Details of the Exploit</strong></p><p><span lang=\"en\">Crema Finance is a concentrated liquidity protocol that provides superior performance for both traders and liquidity providers on Solana network.</span><strong>&nbsp;</strong></p><p>The hacker took advantage of the vulnerability of the Crema Finance protocol to withdraw funds from this platform, but after negotiations between Crema Finance and the attacker, they came to an agreement that the hacker would keep 45455 SOL as a reward for finding the vulnerability, and return the remaining funds back to their ETH network address.</p><p><br></p><p>Exploit step by step:</p><p>1) The hacker created a fake Tick account. Tick Account is a special account that stores price tick data in the Crema Finance platform.</p><p>2) After creating a fake Tick account, the attacker bypassed the standard check for the owner of the Tick account. The fraudster wrote the initialized address of the Pool Tick to a fake account in this transaction: https://solscan.io/tx/5kfoGgEvhBiHXz1MBVxn8rfJh3cf98m3D64YHE2Q1SsXLiaahvdK4hCJfkMA7jQFXLjP9YdNSTMSor3oXbKrLTev</p><p>3) Next, the hacker deployed the contract and used it to provide a flash loan from Solend to add liquidity to Crema to open positions. Contract creations transaction: https://solscan.io/tx/JdorRBPfKNWnZNhWcjwc9Uz5yYaA15CVjT8kLM12tVUqZUu28CqtVEuJ5KpjWHJmVtL7j7sQVhPHHrByhNEKqej</p><p>4) Then the hacker used smart contract to lend a flash loan from Solend to add liquidity on Crema Finance to open positions:</p><p>&nbsp; &nbsp;A) https://solscan.io/tx/5B4QXpMfpDpaX8dg2GF5DVLz9dAiZz1sjPL45wgP7X1o9fpdgCvYKi2FHEosSQBS63uDsos37AyrKC1a4YbKohGv</p><p>&nbsp; &nbsp;B) https://solscan.io/tx/4FaMTKqha9Uw6hvxg5TQc5W7vRDKxVkfPn5GDMThGYSj3tgyCYSzXzQsAsT3dXDY6yZ26iYieV6bcV7bFDkTZ83W</p><p>5) After that, the hacker exchanged tokens for $SOL, some of which are on the Solana account, and the rest was transferred to the ETH blockchain through the Wormhole.</p><p><br></p><p><strong>Block Data Reference</strong></p><p>Attacker addresses:&nbsp;</p><p>Solana: https://solscan.io/account/Esmx2QjmDZMjJ15yBJ2nhqisjEt7Gqro4jSkofdoVsvY</p><p>ETH: https://etherscan.io/address/0x8021b2962db803b73aa874030b0b42c202e8458f</p><p>Attacker's smart contract: https://solscan.io/account/CiDwX4eMS7hfit1oMHK6MCrgve9HVvgm2PAp7Cz6Bck</p><p>Contract creation transaction: https://solscan.io/tx/JdorRBPfKNWnZNhWcjwc9Uz5yYaA15CVjT8kLM12tVUqZUu28CqtVEuJ5KpjWHJmVtL7j7sQVhPHHrByhNEKqej</p><p>Victim address: https://solscan.io/account/Ej4KxxUz73edQzjfsPVWvYxT5eyhQoWoXpo7BYm2Ejhj</p><p><br></p><p>Attacker returning funds transactions:</p><p>1) https://etherscan.io/tx/0xb5935f1fc30921733644de621bb64589f57c650a1985cc5d01c9d24ce03a95bb</p><p>2) https://etherscan.io/tx/0xe7bda58d0d0e7ffdbdfd13326da8d26312442e078a86d6458c276ecbfc3a3d3a</p><p>3) https://solscan.io/tx/5BxSYVzfaNaKT3HsHGrSze2R4Ue5121e2zJH67u7ncFHqauCzpfm92yk3ULDrtHwt46dF44NwyDC3mYx2cVJDtrS</p><p>4) https://solscan.io/tx/5sN74N2Mb9TrbU5LZ5VqyeX5xroeLSaXkWdzzNVbA1sYw7EumvDKBTiRinUdf7esCCz81quoEpGQzsjs6uLWYjJx</p>",
    "name_categories": "Exchange (DEX)",
    "token_name": null,
    "proof_archive_link": "https://web.archive.org/web/20220703155423/https://twitter.com/Crema_Finance/status/1543416225622941696, https://web.archive.org/web/20220703115222/https://twitter.com/CertiKAlert/status/1543562591749947393, https://web.archive.org/web/20220703070336/https://twitter.com/CertiKAlert/status/1543490434399408129, https://web.archive.org/web/20220704092155/https://twitter.com/Crema_Finance/status/1543638844410499073",
    "technical_issue": null,
    "token_address": null,
    "token_addresses": [],
    "logo_link": "safe/files/scamDatabase/logo/62c45ed63c7b1.png",
    "date": "2022-7-2",
    "scam_updates": [],
    "proof_link": "https://www.coindesk.com/tech/2022/07/04/solana-defi-protocol-crema-loses-88m-in-exploit/, https://news.bitcoin.com/exploit-forces-crema-finance-to-temporarily-suspend-services-8-7-million-stolen/, https://www.certik.com/resources/blog/4XzSJEeWC2bRppR9CeBckw-crema-finance-exploit, https://www.binance.com/en/news/flash/7143600",
    "website_link": "https://www.crema.finance/",
    "webarchive_link": "https://web.archive.org/web/20220613072057/https://www.crema.finance/",
    "twitter_link": "https://twitter.com/Crema_Finance",
    "telegram_link": "https://t.me/cremafinance",
    "our_post_link": null,
    "funds_lost": 8782446,
    "funds_returned": 7356932,
    "funds_by_chains": [],
    "funds_recovered": null,
    "active": 1,
    "git_hub": "https://github.com/CremaFinance",
    "git_hub_contract_link": null,
    "discord": "https://discord.com/invite/cremafinance",
    "bug_bounty_program_link": null,
    "bug_bounty_program_company": null,
    "audit_code_conf": null,
    "is_verified_source_code": 1,
    "is_public_team": 0,
    "scam_type": {
        "id": 19,
        "type": "Other"
    },
    "network": {},
    "scamNetworks": [
        {
            "networks_id": 1002,
            "scam_database_id": 3071,
            "networks": {
                "id": 1002,
                "name": "Solana",
                "icon_link": "safe/files/network/solana.png"
            }
        }
    ],
    "auditedBy": [
        {
            "audit_link": "safe/files/audit/pdf/624d0ba2e7b2065110733ccb_Crema_Finance_Audit_Bramah.pdf",
            "date": "2022-02-03T00:00:00.000Z",
            "partner": {
                "id": 49,
                "name": "Bramah Systems",
                "logo_link": "safe/files/partner/logo/60df3221eaf2b.png"
            }
        }
    ]
}